<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRMaker</title>

    <link rel="stylesheet" href="/css/qr.css">
    <link rel="stylesheet" href="/DisenioWeb/css/qr.css">

    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <script defer src="/js/qr.js"></script>
    <script defer src="/DisenioWeb/js/qr.js"></script>

    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>


    <div class="contenedor">
        <h1>Generador de QR</h1>
        <form action="" id="formulario" class="formulario">
            <input style="display: flex; justify-content: center;" type="text" name="" id="link" placeholder="Escribe el texto o URL">
            <br>
            <button class="btn">Generar QR</button>
            <button class="btn" id="btnToPDF" onclick="downloadPNG('contenedorQR', prompt('Ponga el nombre de su archivo'))">Download QR as PNG</button>
        </form>

        <div class="contenedorQR" id="contenedorQR">

        </div>

        <!-- <h2>I hope you enjoy this, feel free to share the link! or make a QR and share it!</h2> -->
    </div>

    <!-- Funcion para descargar el QR -->

    <script>
        function downloadPNG(pdf, filename = '') {
            var downloadLink;
            var dataType = 'image/png';
            var pdfSelect = document.getElementById(pdf);
            
            var pdfHTML = pdfSelect.lastChild.src;
            
            // Specify file name
            filename = filename ? filename + '.png' : 'miQR1.png';

            // Create download link element
            downloadLink = document.createElement("a");

            document.body.appendChild(downloadLink);

            if (navigator.msSaveOrOpenBlob) {
                var blob = new Blob(['ufeff', pdfHTML], {
                    type: dataType
                });
                navigator.msSaveOrOpenBlob(blob, filename);
            } else {
                // Create a link to the file
                
                downloadLink.href = pdfHTML;
                console.log(downloadLink.href)

                // Setting the file name
                downloadLink.download = filename;

                //triggering the function
                downloadLink.click();
            }
        }
    
    </script>
</body>

</html>